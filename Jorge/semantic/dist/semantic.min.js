$(document).ready(function(){
   
    $(document).on('click', 'a', function(event){ 
        event.preventDefault(); 
        var url = $(this).attr('href'); 
        window.open(url, '_blank');
    });

    $("#searchBTN").on("click", function(){
        $('html, body').animate({
            scrollTop: $("#results").offset().top
        }, 1500);
        firstApi();
        
    })
    
    function firstApi(){
        var jobTitle = $("#jobTitel").val();
        var location = $("#location").val();
        var queryURL1 = "https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json?description=" + jobTitle + "&location=" + location;
        $.get(queryURL1).then(function(response){
            if(response.length == 0){
            $(".popup, .popup-content").addClass("active");
            }
            else{
                secondApi();
                for(var i = 0; i<response.length; i++){
                    $("#results").append($("<tr>").addClass("collapsible").append(($)("<img>").attr("src",response[i].company_logo )).append("   " + response[i].title + " - " + response[i].location).append($("<tr>").addClass("content").append(response[i].description)).append($("<a> Apply </a>").addClass("button").attr("href", response[i].url)));
                }
            }
        }) 
    }
    
    $(".close, .popup").on("click", function(){
        $(".popup, .popup-content").removeClass("active");
    });

    function secondApi(){
        var queryURL2 = "https://api.nytimes.com/svc/search/v2/articlesearch.json?q=technology&fq=Opinion&api-key=aiYHThXbjrJO5XKf0V2RMyi2CgGGDkzA";
        
        $.get(queryURL2).then(function(response){
            console.log(response);
            for(var i = 0; i<5; i++){
                $("#articles").append($("<tr>").addClass("articlesLayout").append(($)("<img>").attr("src","https://www.nytimes.com/" + response.response.docs[i].multimedia[3].url)).append($("<tr>").addClass("titleArtice").append("<h5>" + response.response.docs[i].headline.main + "</h5>")).append($("<tr>").addClass("snippet").append(response.response.docs[i].snippet)).append($("<a> Read Article </a>").addClass("button2").attr("href", response.response.docs[i].web_url)));
            }
        })
    }
    $(document).ajaxStart(function(){
        // Show image container
        $("#loader").show();
      });
      $(document).ajaxComplete(function(){
        // Hide image container
        $("#loader").hide();
      });
        
});